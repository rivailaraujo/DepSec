package com.rivail.services

import groovy.json.JsonOutput

class VulnerabilityAggregatorService {

    Map combineResults(Map sonatypeResult, Map githubResult) {
        def combined = [:]
        combined.package = sonatypeResult.package ?: githubResult.package
        combined.vulnerabilities = []

        if (sonatypeResult.vulnerabilities) {
            combined.vulnerabilities.addAll(sonatypeResult.vulnerabilities)
        }
        if (githubResult.vulnerabilities) {
            combined.vulnerabilities.addAll(githubResult.vulnerabilities)
        }

        return combined
    }

    String toJson(Map combinedResult) {
        return JsonOutput.prettyPrint(JsonOutput.toJson(combinedResult))
    }
}
